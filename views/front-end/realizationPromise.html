<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>æ‰‹å†™Promise | CoderBY</title>
    <meta name="generator" content="VuePress 1.7.1">
    <script language="javascript" type="text/javascript" src="https://cdn.staticfile.org/jquery/1.7.2/jquery.min.js"></script>
    <script language="javascript" type="text/jsvascript" src="https://aframe.io/releases/1.1.0/aframe.min.js"></script>
    <meta name="description" content="ç§¯ä¸æˆå¯¸ï¼Œç§¯å¯¸æˆå°ºï¼›å¯¸å°ºæ°´å·²ï¼Œé‚æˆä¸ˆåŒ¹ã€‚">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/blog/assets/css/0.styles.b39a1062.css" as="style"><link rel="preload" href="/blog/assets/js/app.192c93be.js" as="script"><link rel="preload" href="/blog/assets/js/6.6182f73c.js" as="script"><link rel="preload" href="/blog/assets/js/1.e10df0b8.js" as="script"><link rel="preload" href="/blog/assets/js/31.aa382232.js" as="script"><link rel="preload" href="/blog/assets/js/17.3a63db61.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.8b8f201a.js"><link rel="prefetch" href="/blog/assets/js/11.8236576a.js"><link rel="prefetch" href="/blog/assets/js/12.ccea2f0f.js"><link rel="prefetch" href="/blog/assets/js/13.717fd818.js"><link rel="prefetch" href="/blog/assets/js/14.f35354d7.js"><link rel="prefetch" href="/blog/assets/js/15.7a1b5fc3.js"><link rel="prefetch" href="/blog/assets/js/16.495e39cf.js"><link rel="prefetch" href="/blog/assets/js/18.b95f19c4.js"><link rel="prefetch" href="/blog/assets/js/19.51b0e517.js"><link rel="prefetch" href="/blog/assets/js/2.a824289b.js"><link rel="prefetch" href="/blog/assets/js/20.ae8bdc49.js"><link rel="prefetch" href="/blog/assets/js/21.aea43ab4.js"><link rel="prefetch" href="/blog/assets/js/22.66f232af.js"><link rel="prefetch" href="/blog/assets/js/23.a7b97c8d.js"><link rel="prefetch" href="/blog/assets/js/24.b4a3858c.js"><link rel="prefetch" href="/blog/assets/js/25.67787e36.js"><link rel="prefetch" href="/blog/assets/js/26.5d29ac14.js"><link rel="prefetch" href="/blog/assets/js/27.b2f0f4d8.js"><link rel="prefetch" href="/blog/assets/js/28.827d2777.js"><link rel="prefetch" href="/blog/assets/js/29.5cb51950.js"><link rel="prefetch" href="/blog/assets/js/30.91948daa.js"><link rel="prefetch" href="/blog/assets/js/32.cc2ac21c.js"><link rel="prefetch" href="/blog/assets/js/33.7651f735.js"><link rel="prefetch" href="/blog/assets/js/34.97216e1d.js"><link rel="prefetch" href="/blog/assets/js/7.808b7d20.js"><link rel="prefetch" href="/blog/assets/js/8.6754dec6.js"><link rel="prefetch" href="/blog/assets/js/9.76b00e71.js"><link rel="prefetch" href="/blog/assets/js/vendors~docsearch.65d5d153.js"><link rel="prefetch" href="/blog/assets/js/vendors~flowchart.8b09db0e.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.b39a1062.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div><div class="theme-container" data-v-4d80cb8a><div data-v-4d80cb8a><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-4d80cb8a data-v-4d80cb8a><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-0b619cf4 data-v-4d80cb8a data-v-4d80cb8a><h3 class="title" style="display:none;" data-v-0b619cf4 data-v-0b619cf4>CoderBY</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-0b619cf4 data-v-0b619cf4><input type="password" value="" data-v-0b619cf4> <span data-v-0b619cf4>Konck! Knock!</span> <button data-v-0b619cf4>OK</button></label> <div class="footer" style="display:none;" data-v-0b619cf4 data-v-0b619cf4><span data-v-0b619cf4><i class="iconfont reco-theme" data-v-0b619cf4></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-0b619cf4>vuePress-theme-reco</a></span> <span data-v-0b619cf4><i class="iconfont reco-copyright" data-v-0b619cf4></i> <a data-v-0b619cf4><span data-v-0b619cf4>CoderBY</span>
          Â Â 
          <span data-v-0b619cf4>2019 - </span>
          2020
        </a></span></div></div> <div class="hide" data-v-4d80cb8a><header class="navbar" data-v-4d80cb8a><div title="å¯¼èˆª" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/vuepress/head-fish.jpg" alt="CoderBY" class="logo"> <span class="site-name">CoderBY</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">é€‰æ‹©ä¸»é¢˜</h4> <ul class="color-mode-options"><li class="dark">å¤œæ™š</li><li class="auto active">è‡ªåŠ¨</li><li class="light">ç™½å¤©</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/index.html" class="nav-link"><i class="iconfont reco-home"></i>
  ä¸»é¡µ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      åˆ†ç±»
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/categories/å‰ç«¯/" class="nav-link"><i class="iconfont undefined"></i>
  å‰ç«¯
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/æ€»ç»“/" class="nav-link"><i class="iconfont undefined"></i>
  æ€»ç»“
</a></li></ul></div></div><div class="nav-item"><a href="/blog/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  æ ‡ç­¾
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-document"></i>
      å¸¸ç”¨ç½‘å€
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>é¡¹ç›®ğŸˆ</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/other/project.html" class="nav-link"><i class="iconfont undefined"></i>
  æˆ‘çš„é¡¹ç›®
</a></li></ul></li><li class="dropdown-item"><h4>å¸¸ç”¨ç½‘å€ğŸˆ</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://developer.mozilla.org/zh-CN/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  MDN Webæ–‡æ¡£
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://www.iconfont.cn/home/index?spm=a313x.7781069.1998910419.2" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  icon-font
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://www.bootcss.com/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  Bootstrap
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://react.docschina.org/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  React.js
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://leetcode-cn.com/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  LeetCode
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://c.runoob.com/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  èœé¸Ÿå·¥å…·
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://cn.vuejs.org/v2/guide/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  Vue.js
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://www.bootcdn.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  BootCDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://www.linuxcool.com/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  Linuxå‘½ä»¤å¤§å…¨
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://www.tiobe.com/tiobe-index/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  ç¼–ç¨‹è¯­è¨€æ’è¡Œæ¦œ
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div><div class="nav-item"><a href="/blog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  æ—¶é—´çº¿
</a></div><div class="nav-item"><a href="/blog/about/" class="nav-link"><i class="iconfont reco-account"></i>
  å…³äºæˆ‘
</a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-4d80cb8a></div> <aside class="sidebar" data-v-4d80cb8a><div class="personal-info-wrapper" data-v-79645776><img src="/blog/vuepress/head-fish.jpg" alt="author-avatar" class="personal-img" data-v-79645776> <h3 class="name" data-v-79645776>
    CoderBY
  </h3> <div class="num" data-v-79645776><div data-v-79645776><h3 data-v-79645776>10</h3> <h6 data-v-79645776>æ–‡ç« </h6></div> <div data-v-79645776><h3 data-v-79645776>6</h3> <h6 data-v-79645776>æ ‡ç­¾</h6></div></div> <hr data-v-79645776></div> <nav class="nav-links"><div class="nav-item"><a href="/blog/index.html" class="nav-link"><i class="iconfont reco-home"></i>
  ä¸»é¡µ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      åˆ†ç±»
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/categories/å‰ç«¯/" class="nav-link"><i class="iconfont undefined"></i>
  å‰ç«¯
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/æ€»ç»“/" class="nav-link"><i class="iconfont undefined"></i>
  æ€»ç»“
</a></li></ul></div></div><div class="nav-item"><a href="/blog/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  æ ‡ç­¾
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-document"></i>
      å¸¸ç”¨ç½‘å€
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>é¡¹ç›®ğŸˆ</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/other/project.html" class="nav-link"><i class="iconfont undefined"></i>
  æˆ‘çš„é¡¹ç›®
</a></li></ul></li><li class="dropdown-item"><h4>å¸¸ç”¨ç½‘å€ğŸˆ</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://developer.mozilla.org/zh-CN/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  MDN Webæ–‡æ¡£
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://www.iconfont.cn/home/index?spm=a313x.7781069.1998910419.2" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  icon-font
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://www.bootcss.com/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  Bootstrap
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://react.docschina.org/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  React.js
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://leetcode-cn.com/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  LeetCode
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://c.runoob.com/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  èœé¸Ÿå·¥å…·
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://cn.vuejs.org/v2/guide/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  Vue.js
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://www.bootcdn.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  BootCDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://www.linuxcool.com/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  Linuxå‘½ä»¤å¤§å…¨
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://www.tiobe.com/tiobe-index/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  ç¼–ç¨‹è¯­è¨€æ’è¡Œæ¦œ
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div><div class="nav-item"><a href="/blog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  æ—¶é—´çº¿
</a></div><div class="nav-item"><a href="/blog/about/" class="nav-link"><i class="iconfont reco-account"></i>
  å…³äºæˆ‘
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>æ‰‹å†™Promise</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/views/front-end/realizationPromise.html#å®ç°ä¸€ä¸ªç®€æ˜“ç‰ˆ-promise" class="sidebar-link">å®ç°ä¸€ä¸ªç®€æ˜“ç‰ˆ Promise</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog/views/front-end/realizationPromise.html#å®ç°ä¸€ä¸ªç¬¦åˆ-promise-a-è§„èŒƒçš„-promise" class="sidebar-link">å®ç°ä¸€ä¸ªç¬¦åˆ Promise/A+ è§„èŒƒçš„ Promise</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-0b619cf4 data-v-4d80cb8a><h3 class="title" style="display:none;" data-v-0b619cf4 data-v-0b619cf4>æ‰‹å†™Promise</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-0b619cf4 data-v-0b619cf4><input type="password" value="" data-v-0b619cf4> <span data-v-0b619cf4>Konck! Knock!</span> <button data-v-0b619cf4>OK</button></label> <div class="footer" style="display:none;" data-v-0b619cf4 data-v-0b619cf4><span data-v-0b619cf4><i class="iconfont reco-theme" data-v-0b619cf4></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-0b619cf4>vuePress-theme-reco</a></span> <span data-v-0b619cf4><i class="iconfont reco-copyright" data-v-0b619cf4></i> <a data-v-0b619cf4><span data-v-0b619cf4>CoderBY</span>
          Â Â 
          <span data-v-0b619cf4>2019 - </span>
          2020
        </a></span></div></div> <div data-v-4d80cb8a><main class="page"><!----> <div class="page-title" style="display:none;"><h1>æ‰‹å†™Promise</h1> <hr> <div data-v-09556aba><i class="iconfont reco-account" data-v-09556aba><span data-v-09556aba>CoderBY</span></i> <i class="iconfont reco-date" data-v-09556aba><span data-v-09556aba>2020-12-17</span></i> <!----> <i class="iconfont reco-tag tags" data-v-09556aba><span class="tag-item" data-v-09556aba>
      javascript jsé«˜çº§
    </span></i></div></div> <div class="theme-reco-content content__default" style="display:none;"><p>æ‰‹å†™ä¸€ä¸ªç¬¦åˆ Promise/A+ è§„èŒƒçš„ Promise æ¥æ·±å…¥ç†è§£å®ƒ</p> <div id="boxx" data-v-e16ac808><div data-v-e16ac808><p v-if="true" class="custom-block-title" data-v-e16ac808></p> <p v-if="true" data-v-e16ac808></p></div></div> <h2 id="å®ç°ä¸€ä¸ªç®€æ˜“ç‰ˆ-promise"><a href="#å®ç°ä¸€ä¸ªç®€æ˜“ç‰ˆ-promise" class="header-anchor">#</a> å®ç°ä¸€ä¸ªç®€æ˜“ç‰ˆ Promise</h2> <p>åœ¨å®Œæˆç¬¦åˆ Promise/A+ è§„èŒƒçš„ä»£ç ä¹‹å‰ï¼Œå…ˆæ¥å®ç°ä¸€ä¸ªç®€æ˜“ç‰ˆ Promiseï¼Œåœ¨é¢è¯•ä¸­ï¼Œå¦‚æœèƒ½å®ç°å‡ºä¸€ä¸ªç®€æ˜“ç‰ˆçš„ Promise åŸºæœ¬å¯ä»¥è¿‡å…³äº†ã€‚</p> <p>é¦–å…ˆæ¥æ­å»ºæ„å»ºå‡½æ•°çš„å¤§ä½“æ¡†æ¶</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token constant">PENDING</span> <span class="token operator">=</span> <span class="token string">'pending'</span>
<span class="token keyword">const</span> <span class="token constant">RESOLVED</span> <span class="token operator">=</span> <span class="token string">'resolved'</span>
<span class="token keyword">const</span> <span class="token constant">REJECTED</span> <span class="token operator">=</span> <span class="token string">'rejected'</span>

<span class="token keyword">function</span> <span class="token function">MyPromise</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> that <span class="token operator">=</span> <span class="token keyword">this</span>
  that<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token constant">PENDING</span>
  that<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">null</span>
  that<span class="token punctuation">.</span>resolvedCallbacks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  that<span class="token punctuation">.</span>rejectedCallbacks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token comment">// å¾…å®Œå–„ resolve å’Œ reject å‡½æ•°</span>
  <span class="token comment">// å¾…å®Œå–„æ‰§è¡Œ fn å‡½æ•°</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ul><li><p>é¦–å…ˆæˆ‘ä»¬åˆ›å»ºäº†ä¸‰ä¸ªå¸¸é‡ç”¨äºè¡¨ç¤ºçŠ¶æ€ï¼Œå¯¹äºç»å¸¸ä½¿ç”¨çš„ä¸€äº›å€¼éƒ½åº”è¯¥é€šè¿‡å¸¸é‡æ¥ç®¡ç†ï¼Œä¾¿äºå¼€å‘åŠåæœŸç»´æŠ¤</p></li> <li><p>åœ¨å‡½æ•°ä½“å†…éƒ¨é¦–å…ˆåˆ›å»ºäº†å¸¸é‡ <code>that</code>ï¼Œå› ä¸ºä»£ç å¯èƒ½ä¼šå¼‚æ­¥æ‰§è¡Œï¼Œç”¨äºè·å–æ­£ç¡®çš„ <code>this</code> å¯¹è±¡</p></li> <li><p>ä¸€å¼€å§‹ <code>Promise</code> çš„çŠ¶æ€åº”è¯¥æ˜¯ <code>pending</code></p></li> <li><p><code>value</code> å˜é‡ç”¨äºä¿å­˜ <code>resolve</code> æˆ–è€… <code>reject</code> ä¸­ä¼ å…¥çš„å€¼</p></li> <li><p><code>resolvedCallbacks</code> å’Œ <code>rejectedCallbacks</code> ç”¨äºä¿å­˜ <code>then</code> ä¸­çš„å›è°ƒï¼Œå› ä¸ºå½“æ‰§è¡Œå®Œ <code>Promise</code> æ—¶çŠ¶æ€å¯èƒ½è¿˜æ˜¯ç­‰å¾…ä¸­ï¼Œè¿™æ—¶å€™åº”è¯¥æŠŠ <code>then</code> ä¸­çš„å›è°ƒä¿å­˜èµ·æ¥ç”¨äºçŠ¶æ€æ”¹å˜æ—¶ä½¿ç”¨</p></li></ul> <p>æ¥ä¸‹æ¥å®Œå–„ <code>resolve</code> å’Œ <code>reject</code> å‡½æ•°ï¼Œæ·»åŠ åœ¨ <code>MyPromise</code> å‡½æ•°ä½“å†…éƒ¨</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>that<span class="token punctuation">.</span>state <span class="token operator">===</span> <span class="token constant">PENDING</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    that<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token constant">RESOLVED</span>
    that<span class="token punctuation">.</span>value <span class="token operator">=</span> value
    that<span class="token punctuation">.</span>resolvedCallbacks<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">cb</span> <span class="token operator">=&gt;</span> <span class="token function">cb</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">reject</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>that<span class="token punctuation">.</span>state <span class="token operator">===</span> <span class="token constant">PENDING</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    that<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token constant">REJECTED</span>
    that<span class="token punctuation">.</span>value <span class="token operator">=</span> value
    that<span class="token punctuation">.</span>rejectedCallbacks<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">cb</span> <span class="token operator">=&gt;</span> <span class="token function">cb</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>è¿™ä¸¤ä¸ªå‡½æ•°ä»£ç ç±»ä¼¼ï¼Œå°±ä¸€èµ·è§£æäº†</p> <ul><li>é¦–å…ˆä¸¤ä¸ªå‡½æ•°éƒ½å¾—åˆ¤æ–­å½“å‰çŠ¶æ€æ˜¯å¦ä¸ºç­‰å¾…ä¸­ï¼Œå› ä¸ºè§„èŒƒè§„å®šåªæœ‰ç­‰å¾…æ€æ‰å¯ä»¥æ”¹å˜çŠ¶æ€</li> <li>å°†å½“å‰çŠ¶æ€æ›´æ”¹ä¸ºå¯¹åº”çŠ¶æ€ï¼Œå¹¶ä¸”å°†ä¼ å…¥çš„å€¼èµ‹å€¼ç»™ <code>value</code></li> <li>éå†å›è°ƒæ•°ç»„å¹¶æ‰§è¡Œ</li></ul> <p>å®Œæˆä»¥ä¸Šä¸¤ä¸ªå‡½æ•°ä»¥åï¼Œè¯¥å®ç°å¦‚ä½•æ‰§è¡Œ <code>Promise</code> ä¸­ä¼ å…¥çš„å‡½æ•°äº†</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token function">fn</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">reject</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>å®ç°å¾ˆç®€å•ï¼Œæ‰§è¡Œä¼ å…¥çš„å‚æ•°å¹¶ä¸”å°†ä¹‹å‰ä¸¤ä¸ªå‡½æ•°å½“åšå‚æ•°ä¼ è¿›å»</li> <li>è¦æ³¨æ„çš„æ˜¯ï¼Œå¯èƒ½æ‰§è¡Œå‡½æ•°è¿‡ç¨‹ä¸­ä¼šé‡åˆ°é”™è¯¯ï¼Œéœ€è¦æ•è·é”™è¯¯å¹¶ä¸”æ‰§è¡Œ <code>reject</code> å‡½æ•°</li></ul> <p>æœ€åæ¥å®ç°è¾ƒä¸ºå¤æ‚çš„ <code>then</code> å‡½æ•°</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token class-name">MyPromise</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">then</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">onFulfilled<span class="token punctuation">,</span> onRejected</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> that <span class="token operator">=</span> <span class="token keyword">this</span>
  onFulfilled <span class="token operator">=</span> <span class="token keyword">typeof</span> onFulfilled <span class="token operator">===</span> <span class="token string">'function'</span> <span class="token operator">?</span> <span class="token function-variable function">onFulfilled</span> <span class="token operator">:</span> <span class="token parameter">v</span> <span class="token operator">=&gt;</span> v
  onRejected <span class="token operator">=</span>
    <span class="token keyword">typeof</span> onRejected <span class="token operator">===</span> <span class="token string">'function'</span>
      <span class="token operator">?</span> <span class="token function-variable function">onRejected</span>
      <span class="token operator">:</span> <span class="token parameter">r</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">throw</span> r
        <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>that<span class="token punctuation">.</span>state <span class="token operator">===</span> <span class="token constant">PENDING</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    that<span class="token punctuation">.</span>resolvedCallbacks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>onFulfilled<span class="token punctuation">)</span>
    that<span class="token punctuation">.</span>rejectedCallbacks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>onRejected<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>that<span class="token punctuation">.</span>state <span class="token operator">===</span> <span class="token constant">RESOLVED</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">onFulfilled</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>that<span class="token punctuation">.</span>state <span class="token operator">===</span> <span class="token constant">REJECTED</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">onRejected</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><ul><li>é¦–å…ˆåˆ¤æ–­ä¸¤ä¸ªå‚æ•°æ˜¯å¦ä¸ºå‡½æ•°ç±»å‹ï¼Œå› ä¸ºè¿™ä¸¤ä¸ªå‚æ•°æ˜¯å¯é€‰å‚æ•°</li> <li>å½“å‚æ•°ä¸æ˜¯å‡½æ•°ç±»å‹æ—¶ï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ªå‡½æ•°èµ‹å€¼ç»™å¯¹åº”çš„å‚æ•°ï¼ŒåŒæ—¶ä¹Ÿå®ç°äº†é€ä¼ ï¼Œæ¯”å¦‚å¦‚ä¸‹ä»£ç </li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// è¯¥ä»£ç ç›®å‰åœ¨ç®€å•ç‰ˆä¸­ä¼šæŠ¥é”™</span>
<span class="token comment">// åªæ˜¯ä½œä¸ºä¸€ä¸ªé€ä¼ çš„ä¾‹å­</span>
Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>æ¥ä¸‹æ¥å°±æ˜¯ä¸€ç³»åˆ—åˆ¤æ–­çŠ¶æ€çš„é€»è¾‘ï¼Œå½“çŠ¶æ€ä¸æ˜¯ç­‰å¾…æ€æ—¶ï¼Œå°±å»æ‰§è¡Œç›¸å¯¹åº”çš„å‡½æ•°ã€‚å¦‚æœçŠ¶æ€æ˜¯ç­‰å¾…æ€çš„è¯ï¼Œå°±å¾€å›è°ƒå‡½æ•°ä¸­ <code>push</code> å‡½æ•°ï¼Œæ¯”å¦‚å¦‚ä¸‹ä»£ç å°±ä¼šè¿›å…¥ç­‰å¾…æ€çš„é€»è¾‘</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">MyPromise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>ä»¥ä¸Šå°±æ˜¯ç®€å•ç‰ˆ <code>Promise</code> å®ç°ï¼Œæ¥ä¸‹æ¥ä¸€å°èŠ‚æ˜¯å®ç°å®Œæ•´ç‰ˆ <code>Promise</code> çš„è§£æï¼Œç›¸ä¿¡çœ‹å®Œå®Œæ•´ç‰ˆçš„ä½ ï¼Œä¸€å®šä¼šå¯¹äº <code>Promise</code> çš„ç†è§£æ›´ä¸Šä¸€å±‚æ¥¼ã€‚</p> <h2 id="å®ç°ä¸€ä¸ªç¬¦åˆ-promise-a-è§„èŒƒçš„-promise"><a href="#å®ç°ä¸€ä¸ªç¬¦åˆ-promise-a-è§„èŒƒçš„-promise" class="header-anchor">#</a> å®ç°ä¸€ä¸ªç¬¦åˆ Promise/A+ è§„èŒƒçš„ Promise</h2> <p>æˆ‘ä»¬å…ˆæ¥æ”¹é€ ä¸€ä¸‹ <code>resolve</code> å’Œ <code>reject</code> å‡½æ•°</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token keyword">instanceof</span> <span class="token class-name">MyPromise</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> value<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>that<span class="token punctuation">.</span>state <span class="token operator">===</span> <span class="token constant">PENDING</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      that<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token constant">RESOLVED</span>
      that<span class="token punctuation">.</span>value <span class="token operator">=</span> value
      that<span class="token punctuation">.</span>resolvedCallbacks<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">cb</span> <span class="token operator">=&gt;</span> <span class="token function">cb</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">reject</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>that<span class="token punctuation">.</span>state <span class="token operator">===</span> <span class="token constant">PENDING</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      that<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token constant">REJECTED</span>
      that<span class="token punctuation">.</span>value <span class="token operator">=</span> value
      that<span class="token punctuation">.</span>rejectedCallbacks<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">cb</span> <span class="token operator">=&gt;</span> <span class="token function">cb</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><ul><li>å¯¹äº resolve å‡½æ•°æ¥è¯´ï¼Œé¦–å…ˆéœ€è¦åˆ¤æ–­ä¼ å…¥çš„å€¼æ˜¯å¦ä¸º <code>Promise</code> ç±»å‹</li> <li>ä¸ºäº†ä¿è¯å‡½æ•°æ‰§è¡Œé¡ºåºï¼Œéœ€è¦å°†ä¸¤ä¸ªå‡½æ•°ä½“ä»£ç ä½¿ç”¨ <code>setTimeout</code> åŒ…è£¹èµ·æ¥</li></ul> <p>æ¥ä¸‹æ¥ç»§ç»­æ”¹é€  <code>then</code> å‡½æ•°ä¸­çš„ä»£ç ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦æ–°å¢ä¸€ä¸ªå˜é‡ <code>promise2</code>ï¼Œå› ä¸ºæ¯ä¸ª <code>then</code> å‡½æ•°éƒ½éœ€è¦è¿”å›ä¸€ä¸ªæ–°çš„ <code>Promise</code> å¯¹è±¡ï¼Œè¯¥å˜é‡ç”¨äºä¿å­˜æ–°çš„è¿”å›å¯¹è±¡ï¼Œç„¶åæˆ‘ä»¬å…ˆæ¥æ”¹é€ åˆ¤æ–­ç­‰å¾…æ€çš„é€»è¾‘</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>that<span class="token punctuation">.</span>state <span class="token operator">===</span> <span class="token constant">PENDING</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>promise2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyPromise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    that<span class="token punctuation">.</span>resolvedCallbacks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> x <span class="token operator">=</span> <span class="token function">onFulfilled</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
        <span class="token function">resolutionProcedure</span><span class="token punctuation">(</span>promise2<span class="token punctuation">,</span> x<span class="token punctuation">,</span> resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>r<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">reject</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    that<span class="token punctuation">.</span>rejectedCallbacks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> x <span class="token operator">=</span> <span class="token function">onRejected</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
        <span class="token function">resolutionProcedure</span><span class="token punctuation">(</span>promise2<span class="token punctuation">,</span> x<span class="token punctuation">,</span> resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>r<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">reject</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><ul><li><p>é¦–å…ˆæˆ‘ä»¬è¿”å›äº†ä¸€ä¸ªæ–°çš„ <code>Promise</code> å¯¹è±¡ï¼Œå¹¶åœ¨ <code>Promise</code> ä¸­ä¼ å…¥äº†ä¸€ä¸ªå‡½æ•°</p></li> <li><p>å‡½æ•°çš„åŸºæœ¬é€»è¾‘è¿˜æ˜¯å’Œä¹‹å‰ä¸€æ ·ï¼Œå¾€å›è°ƒæ•°ç»„ä¸­ <code>push</code> å‡½æ•°</p></li> <li><p>åŒæ ·ï¼Œåœ¨æ‰§è¡Œå‡½æ•°çš„è¿‡ç¨‹ä¸­å¯èƒ½ä¼šé‡åˆ°é”™è¯¯ï¼Œæ‰€ä»¥ä½¿ç”¨äº† <code>try...catch</code> åŒ…è£¹</p></li> <li><p>è§„èŒƒè§„å®šï¼Œæ‰§è¡Œ <code>onFulfilled</code> æˆ–è€… <code>onRejected</code> å‡½æ•°æ—¶ä¼šè¿”å›ä¸€ä¸ª <code>x</code>ï¼Œå¹¶ä¸”æ‰§è¡Œ <code>Promise</code> è§£å†³è¿‡ç¨‹ï¼Œè¿™æ˜¯ä¸ºäº†ä¸åŒçš„ <code>Promise</code> éƒ½å¯ä»¥å…¼å®¹ä½¿ç”¨ï¼Œæ¯”å¦‚ <code>JQuery</code> çš„ <code>Promise</code> èƒ½å…¼å®¹ ES6 çš„ <code>Promise</code></p></li></ul> <p>æ¥ä¸‹æ¥æˆ‘ä»¬æ”¹é€ åˆ¤æ–­æ‰§è¡Œæ€çš„é€»è¾‘</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>that<span class="token punctuation">.</span>state <span class="token operator">===</span> <span class="token constant">RESOLVED</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>promise2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyPromise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> x <span class="token operator">=</span> <span class="token function">onFulfilled</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
        <span class="token function">resolutionProcedure</span><span class="token punctuation">(</span>promise2<span class="token punctuation">,</span> x<span class="token punctuation">,</span> resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>reason<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">reject</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><ul><li><p>å…¶å®å¤§å®¶å¯ä»¥å‘ç°è¿™æ®µä»£ç å’Œåˆ¤æ–­ç­‰å¾…æ€çš„é€»è¾‘åŸºæœ¬ä¸€è‡´ï¼Œæ— éæ˜¯ä¼ å…¥çš„å‡½æ•°çš„å‡½æ•°ä½“éœ€è¦å¼‚æ­¥æ‰§è¡Œï¼Œè¿™ä¹Ÿæ˜¯è§„èŒƒè§„å®šçš„</p></li> <li><p>å¯¹äºåˆ¤æ–­æ‹’ç»æ€çš„é€»è¾‘è¿™é‡Œå°±ä¸ä¸€ä¸€èµ˜è¿°äº†ï¼Œç•™ç»™å¤§å®¶è‡ªå·±å®Œæˆè¿™ä¸ªä½œä¸š</p></li></ul> <p>æœ€åï¼Œå½“ç„¶ä¹Ÿæ˜¯æœ€éš¾çš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯å®ç°å…¼å®¹å¤šç§ <code>Promise</code> çš„ <code>resolutionProcedure</code> å‡½æ•°</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">resolutionProcedure</span><span class="token punctuation">(</span><span class="token parameter">promise2<span class="token punctuation">,</span> x<span class="token punctuation">,</span> resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>promise2 <span class="token operator">===</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">'Error'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>é¦–å…ˆè§„èŒƒè§„å®šäº† <code>x</code> ä¸èƒ½ä¸ <code>promise2</code> ç›¸ç­‰ï¼Œè¿™æ ·ä¼šå‘ç”Ÿå¾ªç¯å¼•ç”¨çš„é—®é¢˜ï¼Œæ¯”å¦‚å¦‚ä¸‹ä»£ç </p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyPromise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> p1 <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> p1
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>ç„¶åéœ€è¦åˆ¤æ–­ <code>x</code> çš„ç±»å‹</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token keyword">instanceof</span> <span class="token class-name">MyPromise</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    x<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">resolutionProcedure</span><span class="token punctuation">(</span>promise2<span class="token punctuation">,</span> value<span class="token punctuation">,</span> resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> reject<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>è¿™é‡Œçš„ä»£ç æ˜¯å®Œå…¨æŒ‰ç…§è§„èŒƒå®ç°çš„ã€‚å¦‚æœ <code>x</code> ä¸º <code>Promise</code> çš„è¯ï¼Œéœ€è¦åˆ¤æ–­ä»¥ä¸‹å‡ ä¸ªæƒ…å†µï¼š</p> <ol><li>å¦‚æœ <code>x</code> å¤„äºç­‰å¾…æ€ï¼Œ<code>Promise</code> éœ€ä¿æŒä¸ºç­‰å¾…æ€ç›´è‡³ <code>x</code> è¢«æ‰§è¡Œæˆ–æ‹’ç»</li> <li>å¦‚æœ <code>x</code> å¤„äºå…¶ä»–çŠ¶æ€ï¼Œåˆ™ç”¨ç›¸åŒçš„å€¼å¤„ç† <code>Promise</code></li></ol> <p>å½“ç„¶ä»¥ä¸Šè¿™äº›æ˜¯è§„èŒƒéœ€è¦æˆ‘ä»¬åˆ¤æ–­çš„æƒ…å†µï¼Œå®é™…ä¸Šæˆ‘ä»¬ä¸åˆ¤æ–­çŠ¶æ€ä¹Ÿæ˜¯å¯è¡Œçš„ã€‚</p> <p>æ¥ä¸‹æ¥æˆ‘ä»¬ç»§ç»­æŒ‰ç…§è§„èŒƒæ¥å®ç°å‰©ä½™çš„ä»£ç </p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> called <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> x <span class="token operator">===</span> <span class="token string">'object'</span> <span class="token operator">||</span> <span class="token keyword">typeof</span> x <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> then <span class="token operator">=</span> x<span class="token punctuation">.</span>then
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> then <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">then</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>
        x<span class="token punctuation">,</span>
        <span class="token parameter">y</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>called<span class="token punctuation">)</span> <span class="token keyword">return</span>
          called <span class="token operator">=</span> <span class="token boolean">true</span>
          <span class="token function">resolutionProcedure</span><span class="token punctuation">(</span>promise2<span class="token punctuation">,</span> y<span class="token punctuation">,</span> resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>called<span class="token punctuation">)</span> <span class="token keyword">return</span>
          called <span class="token operator">=</span> <span class="token boolean">true</span>
          <span class="token function">reject</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>called<span class="token punctuation">)</span> <span class="token keyword">return</span>
    called <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token function">reject</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token function">resolve</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><ul><li><p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªå˜é‡ <code>called</code> ç”¨äºåˆ¤æ–­æ˜¯å¦å·²ç»è°ƒç”¨è¿‡å‡½æ•°</p></li> <li><p>ç„¶ååˆ¤æ–­ <code>x</code> æ˜¯å¦ä¸ºå¯¹è±¡æˆ–è€…å‡½æ•°ï¼Œå¦‚æœéƒ½ä¸æ˜¯çš„è¯ï¼Œå°† <code>x</code> ä¼ å…¥ <code>resolve</code> ä¸­</p></li> <li><p>å¦‚æœ <code>x</code> æ˜¯å¯¹è±¡æˆ–è€…å‡½æ•°çš„è¯ï¼Œå…ˆæŠŠ <code>x.then</code> èµ‹å€¼ç»™ <code>then</code>ï¼Œç„¶ååˆ¤æ–­ <code>then</code> çš„ç±»å‹ï¼Œå¦‚æœä¸æ˜¯å‡½æ•°ç±»å‹çš„è¯ï¼Œå°±å°† <code>x</code> ä¼ å…¥ <code>resolve</code> ä¸­</p></li> <li><p>å¦‚æœ <code>then</code> æ˜¯å‡½æ•°ç±»å‹çš„è¯ï¼Œå°±å°† <code>x</code> ä½œä¸ºå‡½æ•°çš„ä½œç”¨åŸŸ <code>this</code> è°ƒç”¨ä¹‹ï¼Œå¹¶ä¸”ä¼ é€’ä¸¤ä¸ªå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å«åš <code>resolvePromise</code> ï¼Œç¬¬äºŒä¸ªå‚æ•°å«åš <code>rejectPromise</code>ï¼Œä¸¤ä¸ªå›è°ƒå‡½æ•°éƒ½éœ€è¦åˆ¤æ–­æ˜¯å¦å·²ç»æ‰§è¡Œè¿‡å‡½æ•°ï¼Œç„¶åè¿›è¡Œç›¸åº”çš„é€»è¾‘</p></li> <li><p>ä»¥ä¸Šä»£ç åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­å¦‚æœæŠ›é”™äº†ï¼Œå°†é”™è¯¯ä¼ å…¥ <code>reject</code> å‡½æ•°ä¸­</p></li></ul></div> <footer class="page-edit" style="display:none;"><!----> <div class="last-updated"><span class="prefix">æœ€åæ›´æ–°æ—¶é—´: </span> <span class="time">2020/12/21, 16:21:58</span></div></footer> <!----> <!----> <div class="article-list" data-v-61e7bf3a><div class="article-title" data-v-61e7bf3a><a href="/blog/timeline/" class="iconfont icon-shizhong" data-v-61e7bf3a>æœ€è¿‘æ›´æ–°</a></div> <div class="article-wrapper" data-v-61e7bf3a><dl data-v-61e7bf3a><dd data-v-61e7bf3a>01</dd> <dt data-v-61e7bf3a><a href="/blog/views/front-end/JS%20%E8%BF%9B%E9%98%B6%E7%9F%A5%E8%AF%86%E7%82%B9.html" data-v-61e7bf3a><div data-v-61e7bf3a>JSè¿›é˜¶çŸ¥è¯†ç‚¹</div></a> <span data-v-61e7bf3a>12-21</span></dt></dl><dl data-v-61e7bf3a><dd data-v-61e7bf3a>02</dd> <dt data-v-61e7bf3a><a href="/blog/views/front-end/eventLoop.html" data-v-61e7bf3a><div data-v-61e7bf3a>Event Loop</div></a> <span data-v-61e7bf3a>12-21</span></dt></dl><dl data-v-61e7bf3a><dd data-v-61e7bf3a>03</dd> <dt data-v-61e7bf3a><a href="/blog/views/qaq/%E6%B5%8F%E8%A7%88%E5%99%A8%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html" data-v-61e7bf3a><div data-v-61e7bf3a>æµè§ˆå™¨åŸºç¡€çŸ¥è¯†</div></a> <span data-v-61e7bf3a>12-21</span></dt></dl></div> <div data-v-61e7bf3a><a href="/blog/timeline/" class="article-more" data-v-61e7bf3a>æ›´å¤šæ–‡ç«  &gt;</a></div></div></main> <!----> <div class="comments-wrapper" data-v-4d80cb8a><!----></div></div></div></div></div></div><div class="global-ui"><APlayer audio="" fixed="true" mini="true" theme="#f66" loop="loop" order="random" preload="auto" volume="0.7" mutex="true" lrc-type="0" list-max-height="250" storage-name="vuepress-plugin-meting" id="aplayer-fixed"></APlayer><div id="goTop" class="hide-cat" data-v-bf92849a></div><canvas id="vuepress-canvas-cursor"></canvas><div></div><!----></div></div>
    <script src="/blog/assets/js/app.192c93be.js" defer></script><script src="/blog/assets/js/6.6182f73c.js" defer></script><script src="/blog/assets/js/1.e10df0b8.js" defer></script><script src="/blog/assets/js/31.aa382232.js" defer></script><script src="/blog/assets/js/17.3a63db61.js" defer></script>
  </body>
</html>
